#pragma once
#include <vector>
#include "gba_context.h"
#include "instruction_string.h"

#define A_BRANCH_LINK				"101XXXXXXXXXXXXXXXXXXXXX"
#define A_BRANCH_LINK_EXCHANGE		"0001001011111111111100X1"
#define A_SOFWARE_INTERRUPT 		"1111XXXXXXXXXXXXXXXXXXXX"
#define A_ALU_REGISTER_0 			"000XXXXXXXXXXXXXXXXXXXX0"
#define A_ALU_REGISTER_1 			"000XXXXXXXXXXXXXXXXX0XX1"
#define A_ALU_IMMEDIATE 			"001XXXXXXXXXXXXXXXXXXXXX"
#define A_PSR_IMMEDIATE 			"00110X10XXXXXXXXXXXXXXXX"
#define A_PST_REGISTER				"00010XX0XXXXXXXX00000000"
#define A_BKPT						"00010010XXXXXXXXXXXX0111"
#define A_CLZ 						"000101101111XXXX11110001"
#define A_QALU						"00010XX0XXXXXXXX00000101"
#define A_MULTIPLY					"000000XXXXXXXXXXXXXX1001"
#define A_MULTIPLY_LONG 			"00001XXXXXXXXXXXXXXX1001"
#define A_MULTIPLY_HALF 			"00010XX0XXXXXXXXXXXX1XX0"
#define A_TRANS_SWP12 				"00010X00XXXXXXXX00001001"
#define A_TRANS_REGISTER_10 		"000XX0XXXXXXXXXX00001XX1"
#define A_TRANS_IMMEDIATE_10 		"000XX1XXXXXXXXXXXXXX1XX1"
#define A_TRANS_IMMEDIATE_9 		"010XXXXXXXXXXXXXXXXXXXXX"
#define A_TRANS_REGISTER_9			"011XXXXXXXXXXXXXXXXXXXX0"
#define A_UNDEFINED 				"011XXXXXXXXXXXXXXXXXXXX1"
#define A_BLOCK_TRANS 				"100XXXXXXXXXXXXXXXXXXXXX"
#define A_CO_DATA_TRANS 			"110XXXXXXXXXXXXXXXXXXXXX"
#define A_CO_RR						"1100010XXXXXXXXXXXXXXXXX"
#define A_CO_DATA_OP 				"1110XXXXXXXXXXXXXXXXXXX0"
#define A_CO_REGISTER_TRANS 		"1110XXXXXXXXXXXXXXXXXXX1"

#define T_SHIFT						"000XXXXX"
#define T_ADD_SUB					"00011XXX"
#define T_IMMEDIATE					"001XXXXX"
#define T_ALU						"010000XX"
#define T_HIREG_BX					"010001XX"
#define T_LDR_PC					"01001XXX"
#define T_LDR_STR					"0101XX0X"
#define T_LDR_STR_BYTE_HALF			"0101XX1X"
#define T_LDR_STR_IMMEDIATE			"011XXXXX"
#define T_LDR_STR_HALF				"1000XXXX"
#define T_LDR_STR_SP				"1001XXXX"
#define T_ADD_OFFSET_RELATIVE		"1010XXXX"
#define T_ADD_OFFSET_SP				"10110000"
#define T_PUSH_POP					"1011X10X"
#define T_MULTIPLE_LD_ST			"1100XXXX"
#define T_CONDITIONAL_BRANCH		"1101XXXX"
#define T_SOFTWARE_INTERRUPT		"11011111"
#define T_UNCONDITIONAL_BRANCH		"11100XXX"
#define T_LONG_BRANCH_LINK			"11110XXX"

class instruction
{
public:
	bool is_arm;
	bool descending_stack;
	long id;
	status_flag affected_flags;
private:
public:
	virtual ~instruction() = default;
	virtual void run(gba_context* gba) = 0;
	virtual instruction_string print() = 0;
private:
};

//typedef std::vector<instruction*> asmcode;